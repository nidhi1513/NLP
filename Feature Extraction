{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/nidhikandari/feature-extraction?scriptVersionId=192544041\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"0484a83d","metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2024-08-13T19:53:36.534374Z","iopub.status.busy":"2024-08-13T19:53:36.533449Z","iopub.status.idle":"2024-08-13T19:53:37.488976Z","shell.execute_reply":"2024-08-13T19:53:37.487672Z"},"papermill":{"duration":0.964457,"end_time":"2024-08-13T19:53:37.491777","exception":false,"start_time":"2024-08-13T19:53:36.52732","status":"completed"},"tags":[]},"outputs":[],"source":["# This Python 3 environment comes with many helpful analytics libraries installed\n","# It is defined  by the kaggle/python Docker image: https://github.com/kaggle/docker-python\n","# For example, here's several helpful packages to load\n","\n","import numpy as np # linear algebra\n","import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n","\n","# Input data files are available in the read-only \"../input/\" directory\n","# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n","\n","import os\n","for dirname, _, filenames in os.walk('/kaggle/input'):\n","    for filename in filenames:\n","        print(os.path.join(dirname, filename))\n","\n","# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n","# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"]},{"cell_type":"code","execution_count":2,"id":"e8bf0800","metadata":{"execution":{"iopub.execute_input":"2024-08-13T19:53:37.501917Z","iopub.status.busy":"2024-08-13T19:53:37.5014Z","iopub.status.idle":"2024-08-13T19:53:37.51009Z","shell.execute_reply":"2024-08-13T19:53:37.508891Z"},"papermill":{"duration":0.016397,"end_time":"2024-08-13T19:53:37.512508","exception":false,"start_time":"2024-08-13T19:53:37.496111","status":"completed"},"tags":[]},"outputs":[],"source":["df = pd.DataFrame({'text':['people watch campusx','campusx watch campusx','people wrtie comment','campux write comment'],'output':[1,1,0,0]})"]},{"cell_type":"code","execution_count":3,"id":"2ad639d6","metadata":{"execution":{"iopub.execute_input":"2024-08-13T19:53:37.522864Z","iopub.status.busy":"2024-08-13T19:53:37.522479Z","iopub.status.idle":"2024-08-13T19:53:37.544995Z","shell.execute_reply":"2024-08-13T19:53:37.543596Z"},"papermill":{"duration":0.030573,"end_time":"2024-08-13T19:53:37.547662","exception":false,"start_time":"2024-08-13T19:53:37.517089","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>text</th>\n","      <th>output</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>people watch campusx</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>campusx watch campusx</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>people wrtie comment</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>campux write comment</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                    text  output\n","0   people watch campusx       1\n","1  campusx watch campusx       1\n","2   people wrtie comment       0\n","3   campux write comment       0"]},"execution_count":3,"metadata":{},"output_type":"execute_result"}],"source":["df"]},{"cell_type":"code","execution_count":4,"id":"57c93850","metadata":{"execution":{"iopub.execute_input":"2024-08-13T19:53:37.558324Z","iopub.status.busy":"2024-08-13T19:53:37.557502Z","iopub.status.idle":"2024-08-13T19:53:38.811287Z","shell.execute_reply":"2024-08-13T19:53:38.810066Z"},"papermill":{"duration":1.262052,"end_time":"2024-08-13T19:53:38.814074","exception":false,"start_time":"2024-08-13T19:53:37.552022","status":"completed"},"tags":[]},"outputs":[],"source":["from sklearn.feature_extraction.text import CountVectorizer\n","cv = CountVectorizer()"]},{"cell_type":"code","execution_count":5,"id":"29bd5151","metadata":{"execution":{"iopub.execute_input":"2024-08-13T19:53:38.824471Z","iopub.status.busy":"2024-08-13T19:53:38.824047Z","iopub.status.idle":"2024-08-13T19:53:38.841807Z","shell.execute_reply":"2024-08-13T19:53:38.840524Z"},"papermill":{"duration":0.025828,"end_time":"2024-08-13T19:53:38.844358","exception":false,"start_time":"2024-08-13T19:53:38.81853","status":"completed"},"tags":[]},"outputs":[],"source":["bow = cv.fit_transform(df['text'])"]},{"cell_type":"code","execution_count":6,"id":"cc676925","metadata":{"execution":{"iopub.execute_input":"2024-08-13T19:53:38.854978Z","iopub.status.busy":"2024-08-13T19:53:38.854522Z","iopub.status.idle":"2024-08-13T19:53:38.86055Z","shell.execute_reply":"2024-08-13T19:53:38.859485Z"},"papermill":{"duration":0.014409,"end_time":"2024-08-13T19:53:38.863002","exception":false,"start_time":"2024-08-13T19:53:38.848593","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["{'people': 3, 'watch': 4, 'campusx': 0, 'wrtie': 6, 'comment': 2, 'campux': 1, 'write': 5}\n"]}],"source":["print(cv.vocabulary_)"]},{"cell_type":"code","execution_count":7,"id":"5233ccc0","metadata":{"execution":{"iopub.execute_input":"2024-08-13T19:53:38.873323Z","iopub.status.busy":"2024-08-13T19:53:38.872873Z","iopub.status.idle":"2024-08-13T19:53:38.87987Z","shell.execute_reply":"2024-08-13T19:53:38.878498Z"},"papermill":{"duration":0.015053,"end_time":"2024-08-13T19:53:38.882408","exception":false,"start_time":"2024-08-13T19:53:38.867355","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["[[1 0 0 1 1 0 0]]\n","[[2 0 0 0 1 0 0]]\n"]}],"source":["print(bow[0].toarray())\n","print(bow[1].toarray())"]},{"cell_type":"code","execution_count":8,"id":"a8bd1283","metadata":{"execution":{"iopub.execute_input":"2024-08-13T19:53:38.893735Z","iopub.status.busy":"2024-08-13T19:53:38.892378Z","iopub.status.idle":"2024-08-13T19:53:38.90105Z","shell.execute_reply":"2024-08-13T19:53:38.899949Z"},"papermill":{"duration":0.016531,"end_time":"2024-08-13T19:53:38.903274","exception":false,"start_time":"2024-08-13T19:53:38.886743","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["array([[2, 0, 1, 0, 1, 1, 0]])"]},"execution_count":8,"metadata":{},"output_type":"execute_result"}],"source":["cv.transform([\"campusx watch and write comment of campusx\"]).toarray()"]},{"cell_type":"code","execution_count":9,"id":"840a23e1","metadata":{"execution":{"iopub.execute_input":"2024-08-13T19:53:38.914092Z","iopub.status.busy":"2024-08-13T19:53:38.913684Z","iopub.status.idle":"2024-08-13T19:53:38.919177Z","shell.execute_reply":"2024-08-13T19:53:38.917986Z"},"papermill":{"duration":0.013555,"end_time":"2024-08-13T19:53:38.921462","exception":false,"start_time":"2024-08-13T19:53:38.907907","status":"completed"},"tags":[]},"outputs":[],"source":["from sklearn.feature_extraction.text import CountVectorizer\n","cv = CountVectorizer(ngram_range=(1,2))"]},{"cell_type":"code","execution_count":10,"id":"7cb1d318","metadata":{"execution":{"iopub.execute_input":"2024-08-13T19:53:38.931966Z","iopub.status.busy":"2024-08-13T19:53:38.931569Z","iopub.status.idle":"2024-08-13T19:53:38.937921Z","shell.execute_reply":"2024-08-13T19:53:38.936963Z"},"papermill":{"duration":0.014169,"end_time":"2024-08-13T19:53:38.940075","exception":false,"start_time":"2024-08-13T19:53:38.925906","status":"completed"},"tags":[]},"outputs":[],"source":["bow = cv.fit_transform(df['text'])"]},{"cell_type":"code","execution_count":11,"id":"c5b98306","metadata":{"execution":{"iopub.execute_input":"2024-08-13T19:53:38.950692Z","iopub.status.busy":"2024-08-13T19:53:38.95029Z","iopub.status.idle":"2024-08-13T19:53:38.95624Z","shell.execute_reply":"2024-08-13T19:53:38.955039Z"},"papermill":{"duration":0.013997,"end_time":"2024-08-13T19:53:38.958516","exception":false,"start_time":"2024-08-13T19:53:38.944519","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["{'people': 5, 'watch': 8, 'campusx': 0, 'people watch': 6, 'watch campusx': 9, 'campusx watch': 1, 'wrtie': 12, 'comment': 4, 'people wrtie': 7, 'wrtie comment': 13, 'campux': 2, 'write': 10, 'campux write': 3, 'write comment': 11}\n"]}],"source":["print(cv.vocabulary_)"]},{"cell_type":"code","execution_count":12,"id":"03526ea7","metadata":{"execution":{"iopub.execute_input":"2024-08-13T19:53:38.969228Z","iopub.status.busy":"2024-08-13T19:53:38.968822Z","iopub.status.idle":"2024-08-13T19:53:38.985697Z","shell.execute_reply":"2024-08-13T19:53:38.984306Z"},"papermill":{"duration":0.024904,"end_time":"2024-08-13T19:53:38.98793","exception":false,"start_time":"2024-08-13T19:53:38.963026","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["array([[0.57735027, 0.        , 0.        , 0.57735027, 0.57735027,\n","        0.        , 0.        ],\n","       [0.89442719, 0.        , 0.        , 0.        , 0.4472136 ,\n","        0.        , 0.        ],\n","       [0.        , 0.        , 0.52640543, 0.52640543, 0.        ,\n","        0.        , 0.66767854],\n","       [0.        , 0.61761437, 0.48693426, 0.        , 0.        ,\n","        0.61761437, 0.        ]])"]},"execution_count":12,"metadata":{},"output_type":"execute_result"}],"source":["from sklearn.feature_extraction.text import TfidfVectorizer\n","tfidf = TfidfVectorizer()\n","tfidf.fit_transform(df['text']).toarray()"]},{"cell_type":"code","execution_count":13,"id":"d471dc6b","metadata":{"execution":{"iopub.execute_input":"2024-08-13T19:53:38.999226Z","iopub.status.busy":"2024-08-13T19:53:38.998779Z","iopub.status.idle":"2024-08-13T19:53:39.006042Z","shell.execute_reply":"2024-08-13T19:53:39.004603Z"},"papermill":{"duration":0.017267,"end_time":"2024-08-13T19:53:39.00991","exception":false,"start_time":"2024-08-13T19:53:38.992643","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["[1.51082562 1.91629073 1.51082562 1.51082562 1.51082562 1.91629073\n"," 1.91629073]\n","['campusx' 'campux' 'comment' 'people' 'watch' 'write' 'wrtie']\n"]}],"source":["print(tfidf.idf_)\n","print(tfidf.get_feature_names_out())"]},{"cell_type":"code","execution_count":null,"id":"fc3c8fdd","metadata":{"papermill":{"duration":0.00456,"end_time":"2024-08-13T19:53:39.019421","exception":false,"start_time":"2024-08-13T19:53:39.014861","status":"completed"},"tags":[]},"outputs":[],"source":[]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[],"dockerImageVersionId":30746,"isGpuEnabled":false,"isInternetEnabled":false,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.13"},"papermill":{"default_parameters":{},"duration":6.170241,"end_time":"2024-08-13T19:53:39.647204","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2024-08-13T19:53:33.476963","version":"2.5.0"}},"nbformat":4,"nbformat_minor":5}